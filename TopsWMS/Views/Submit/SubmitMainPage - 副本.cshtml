<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>检具室可视化管控平台</title>
    <script src="../../TopsLib/Scripts/jquery-1.5.1.min.js"></script>
    <script src="../../TopsLib/Scripts/jquery.json-2.3.min.js"></script>
    <script src="../../TopsLib/Scripts/highCharts/highcharts.js"></script>
        <script type="text/javascript">
            $(function () {
                var count1 = "";
                var hege1 = "";
                var buhege1 = "";
                var pname1 = new Array();
                var hegedata1 = new Array();
                var buhegedata1 = new Array();
                var count2 = "";
                var hege2 = "";
                var buhege2 = "";
                var pname2 = new Array();
                var hegedata2 = new Array();
                var buhegedata2 = new Array();
                var count3 = "";
                var hege3 = "";
                var buhege3 = "";
                var pname3 = new Array();
                var hegedata3 = new Array();
                var buhegedata3 = new Array();
                var zhouqi = "";
                function show() {

                    var now = new Date();
                    var year = now.getFullYear();//年
                    var month = now.getMonth();//月
                    var date = now.getDate();//日
                    var hour = now.getHours();//时
                    var minute = now.getMinutes();//分
                    var second = now.getSeconds();//秒
                    if (second < 10) {
                        second = "0" + second;
                    }
                    $("#year").html(year + "年" + month + "月" + date + "日");
                    $("#hours").html(hour + ":" + minute + ":" + second)
                    t = setTimeout(show, 500);
                    function checkTime(i) {
                        if (i < 10) {
                            i = "0" + i;
                        }
                        return i;
                    }
                }
                show();
                var heigth=$(window).height();
                var width=$(window).width();
                $("#Main").css("height", heigth);
                $("#Main").css("width", width);
                //
                $.ajax({
                    type: "GET",
                    url: "/AjaxGet/SelMainPage",
                    dealError: false,
                    success: function (data) {
                        var data = JSON.parse(data);
                        if (data.IsSuccess) {
                            if (data.Data["length"] > 0) {
                                var hift = data.Data[2][0].s_hift;
                                if (hift == 1) {
                                    hift = "A班"
                                }
                                else {
                                    hift = "B班";
                                }
                                var position1 = data.Data[1][0].s_position;
                                if (position1 == 1) {
                                    position1 = "班长"
                                }
                                else {
                                    position1 = "测量员";
                                }
                                var position2 = data.Data[2][0].s_position;
                                if (position2 == 1) {
                                    position2 = "班长"
                                }
                                else {
                                    position2 = "测量员";
                                }
                                if (data.Data[0].length == 0) {

                                    $("#Temperature").append("℃");
                                    $("#Humidity").append("%");
                                }
                                else {
                                    $("#Temperature").append(data.Data[0][0].n_Temperature + "℃");
                                    $("#Humidity").append(data.Data[0][0].n_Humidity + "%");
                                }
                                $("#imgMeasure").attr('src', data.Data[1][0].s_Imageurl);
                                $("#MeasureName").append(data.Data[1][0].s_name);
                                $("#Measure").append(position1);
                                $("#shift").append(hift);
                                $("#imgMonitor").attr('src', data.Data[2][0].s_Imageurl);
                                $("#MonitorName").append(data.Data[2][0].s_name);
                                $("#Monitor").append(position2);
                                zhouqi = data.Data[3][0].s_Cycle;
                                if (zhouqi == 1) {
                                    zhouqi = '日';
                                }
                                else if (zhouqi == 2) {
                                    zhouqi = '周';
                                }
                                else if (zhouqi == 3) {
                                    zhouqi = '月';
                                }
                                else {
                                    zhouqi = '年'
                                }
                                $("#TestTime").append(zhouqi+"测量产品数量统计");
                                if (data.Data[4].length > 1) {
                                    count1 = data.Data[4][0].count;
                                    hege1 = data.Data[4][0].hege;
                                    buhege1 = data.Data[4][0].buhege;
                                    for (var i = 1; i < data.Data[4].length; i++) {
                                        pname1.push(data.Data[4][i].count);
                                        hegedata1.push(data.Data[4][i].hege);
                                        buhegedata1.push(data.Data[4][i].buhege);
                                    }
                                    knabanfun1(zhouqi, count1, hege1, buhege1, pname1, hegedata1, buhegedata1);
                                    knabanfun4(zhouqi, count1, hege1, buhege1, pname1, hegedata1, buhegedata1);
                                }
                                if (data.Data[5].length > 1) {
                                    count2 = data.Data[5][0].count;
                                    hege2 = data.Data[5][0].hege;
                                    buhege2 = data.Data[5][0].buhege;
                                    for (var i = 1; i < data.Data[5].length; i++) {
                                        pname2.push(data.Data[5][i].count);
                                        hegedata2.push(data.Data[5][i].hege);
                                        buhegedata2.push(data.Data[5][i].buhege);
                                    }
                                    knabanfun2(zhouqi, count2, hege2, buhege2, pname2, hegedata2, buhegedata2);
                                    knabanfun5(zhouqi, count2, hege2, buhege2, pname2, hegedata2, buhegedata2);
                                }
                                if (data.Data[6].length > 1) {
                                    count3 = data.Data[6][0].count;
                                    hege3 = data.Data[6][0].hege;
                                    buhege3 = data.Data[6][0].buhege;
                                    for (var i = 1; i < data.Data[6].length; i++) {
                                        pname3.push(data.Data[6][i].count);
                                        hegedata3.push(data.Data[6][i].hege);
                                        buhegedata3.push(data.Data[6][i].buhege);
                                    }
                                    knabanfun3(zhouqi, count3, hege3, buhege3, pname3, hegedata3, buhegedata3);
                                    knabanfun6(zhouqi, count3, hege3, buhege3, pname3, hegedata3, buhegedata3);
                                }
                                $(".ProductKB").hide();
                                $(".ProductKB").eq(0).show();
                            } else {
                                alert("暂无数据");
                            }
                           
                          
                           
                        } else {
                            alert("失败：" + data.Msgs[0]);
                        }
                    }
                })
                //注塑
                function knabanfun1(zhouqi, count1, hege1, buhege1, pname1, hegedata1, buhegedata1) {
                    //环图
                  var  credits= {
                            enabled: false
                    };
                       var chart= {
                            spacing: [40, 0, 40, 0],
                            backgroundColor: 'transparent'
                        };
                      var  title= {
                            floating: false,
                            text: '注塑产品 ' + count1 + '件 合格率:' + parseInt(hege1 * 100) + "%",
                            style: {
                                color: '#C9C9CE',
                                fontWeight: 'bold'
                            }
                        };
                      var  tooltip= {
                            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                        };
                       var plotOptions= {
                            pie: {
                                    softConnector: false,
                                    dataLabels: {
                                    connectorWidth: 0
                                    }
                             
                            }
                        };
                       var series= [{
                            size:'160%',
                            type: 'pie',
                            innerSize: '80%',
                            name: '',
                            data: [
                                {
                                    name: '',
                                    y: hege1,
                                    color: '#00FF00'
                                },
                                { name: '', y: buhege1, color: '#10214C' }

                            ]
                        }];
                    
                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container1').highcharts(json);
                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text: '',//zhouqi+'测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname1,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }

                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false
                    };

                    var series = [
                         {
                             name: '测量数量',
                             data: buhegedata1,
                             color: '#92A9D0',

                         },{
                        name: '合格数量',
                        data: hegedata1,
                        color: '#4370A7',

                    }];
                    var legend = {
                        enabled: false,
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '25',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                    json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers1').highcharts(json);
                }

                //喷涂
                function knabanfun2(zhouqi, count2, hege2, buhege2, pname2, hegedata2, buhegedata2) {
                    //环图
                   var credits= {
                            enabled: false
                    };
                      var  chart= {
                            spacing: [40, 0, 40, 0],
                            backgroundColor: 'transparent'
                        };
                      var  title= {
                            floating: false,
                            text: '喷涂产品 ' + count2 + '件 合格率:' + parseInt(hege2 * 100) + "%",
                            style: {
                                color: '#C9C9CE',
                                fontWeight: 'bold'
                            }
                        };
                     var   tooltip= {
                            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                        };
                     var   plotOptions= {
                            pie: {
                                    softConnector: false,
                                    dataLabels: {
                                    connectorWidth: 0
                                    }
                            }
                        };
                      var  series= [{
                            size:'160%',
                            type: 'pie',
                            innerSize: '80%',
                            name: '',
                            data: [
                                { name: '', y: hege2, color: '#00FF00' },
                                { name: '', y: buhege2, color: '#10214C' }

                            ]
                        }];
                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container2').highcharts(json);
                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text:'',// zhouqi + '测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname2,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false,
                        text: '',
                    };

                    var series = [{
                        name: '测量数量',
                        data: buhegedata1,
                        color: '#92A9D0',

                    }, {
                        name: '合格数量',
                        data: hegedata1,
                        color: '#4370A7',

                    }];
                    var legend = {
                        enabled: false,
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '25',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                   json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers2').highcharts(json);
                }

                //装配
                function knabanfun3(zhouqi, count3, hege3, buhege3, pname3, hegedata3, buhegedata3) {
                    //环图
                    var credits= {
                        enabled: false
                    };
                    var chart={
                        spacing: [40, 0, 40, 0],
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        floating: false,
                        text: '装配产品 ' + count3 + '件 合格率:' + parseInt(hege3 * 100) + "%",
                        style: {
                            color: '#C9C9CE',
                            fontWeight: 'bold',
                            size: '15px'
                        }
                    };
                    var tooltip = {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    };
                    var plotOptions = {
                        pie: {
                            softConnector: false,
                            dataLabels: {
                                connectorWidth: 0
                            }
                        }
                    };
                    var series = [{
                        size: '160%',
                        type: 'pie',
                        innerSize: '80%',
                        name: '',
                        data: [
                            { name: '', y: hege3, color: '#00FF00' },
                            { name: '', y: buhege3, color: '#10214C' }

                        ]
                    }];
                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container3').highcharts(json);
                  
                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text:'',// zhouqi + '测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname3,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false
                    };

                    var series = [{
                        name: '测量数量',
                        data: buhegedata1,
                        color: '#92A9D0',

                    }, {
                        name: '合格数量',
                        data: hegedata1,
                        color: '#4370A7',

                    }];
                    var legend = {floating: true,
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '15',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                    json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers3').highcharts(json);
                };
                //注塑
                function knabanfun4(zhouqi, count1, hege1, buhege1, pname1, hegedata1, buhegedata1) {
                    //环图
                    var credits = {
                        enabled: false
                    };
                    var chart = {
                        spacing: [40, 0, 40, 0],
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        floating: false,
                        text: '注塑产品 ' + count1 + '件 合格率:' + parseInt(hege1 * 100) + "%",
                        style: {
                            color: '#C9C9CE',
                            fontWeight: 'bold'
                        }
                    };
                    var tooltip = {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    };
                    var plotOptions = {
                        pie: {
                            softConnector: false,
                            dataLabels: {
                                connectorWidth: 0
                            }

                        }
                    };
                    var series = [{
                        type: 'pie',
                        innerSize: '80%',
                        name: '',
                        data: [
                            {
                                name: '',
                                y: hege1,
                                color: '#00FF00'
                            },
                            { name: '', y: buhege1, color: '#10214C' }

                        ]
                    }];

                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container4').highcharts(json);
                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text: '',//zhouqi+'测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname1,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }

                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false
                    };

                    var series = [
                         {
                             name: '测量数量',
                             data: buhegedata1,
                             color: '#92A9D0',

                         }, {
                             name: '合格数量',
                             data: hegedata1,
                             color: '#4370A7',

                         }];
                    var legend = {
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '35',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                    json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers4').highcharts(json);
                }

                //喷涂
                function knabanfun5(zhouqi, count2, hege2, buhege2, pname2, hegedata2, buhegedata2) {
                    //环图
                    var credits = {
                        enabled: false
                    };
                    var chart = {
                        spacing: [40, 0, 40, 0],
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        floating: false,
                        text: '喷涂产品 ' + count2 + '件 合格率:' + parseInt(hege2 * 100) + "%",
                        style: {
                            color: '#C9C9CE',
                            fontWeight: 'bold'
                        }
                    };
                    var tooltip = {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    };
                    var plotOptions = {
                        pie: {
                            softConnector: false,
                            dataLabels: {
                                connectorWidth: 0
                            }
                        }
                    };
                    var series = [{
                        type: 'pie',
                        innerSize: '80%',
                        name: '',
                        data: [
                            { name: '', y: hege2, color: '#00FF00' },
                            { name: '', y: buhege2, color: '#10214C' }

                        ]
                    }];
                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container5').highcharts(json);
                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text: '',// zhouqi + '测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname2,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false,
                        text: '',
                    };

                    var series = [{
                        name: '测量数量',
                        data: buhegedata1,
                        color: '#92A9D0',

                    }, {
                        name: '合格数量',
                        data: hegedata1,
                        color: '#4370A7',

                    }];
                    var legend = {
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '35',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                    json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers5').highcharts(json);
                }

                //装配
                function knabanfun6(zhouqi, count3, hege3, buhege3, pname3, hegedata3, buhegedata3) {
                    //环图
                    var credits = {
                        enabled: false
                    };
                    var chart = {
                        spacing: [40, 0, 40, 0],
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        floating: false,
                        text: '装配产品 ' + count3 + '件 合格率:' + parseInt(hege3 * 100) + "%",
                        style: {
                            color: '#C9C9CE',
                            fontWeight: 'bold',
                            size: '15px'
                        }
                    };
                    var tooltip = {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    };
                    var plotOptions = {
                        pie: {
                            softConnector: false,
                            dataLabels: {
                                connectorWidth: 0
                            }
                        }
                    };
                    var series = [{
                        type: 'pie',
                        innerSize: '80%',
                        name: '',
                        data: [
                            { name: '', y: hege3, color: '#00FF00' },
                            { name: '', y: buhege3, color: '#10214C' }

                        ]
                    }];
                    var json = {};
                    json.credits = credits;
                    json.chart = chart;
                    json.title = title;
                    json.tooltip = tooltip;
                    json.plotOptions = plotOptions;
                    json.series = series;
                    $('.container6').highcharts(json);

                    //柱形图
                    var chart = {
                        type: 'column',
                        backgroundColor: 'transparent'
                    };
                    var title = {
                        text: '',// zhouqi + '测量产品数据统计',
                        style: {
                            color: 'white',
                            fontWeight: 'bold'
                        }
                    };
                    var xAxis = {
                        categories: pname3,
                        crosshair: true,
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var yAxis = {
                        min: 0,
                        title: {
                            text: '',
                            style: {
                                color: 'white',
                                fontWeight: 'bold'
                            }
                        },
                        labels: {
                            style: {
                                fontFamily: '微软雅黑',
                                color: '#C9C9CE',
                                fontSize: '25px'
                            }
                        }
                    };
                    var tooltip = {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                           '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    };
                    var plotOptions = {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 3,
                            dataLabels: {
                                enabled: true,
                                color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                style: {
                                    // 如果不需要数据标签阴影，可以将 textOutline 设置为 'none'
                                    textOutline: '1px 1px black'
                                }
                            }
                        }
                    };
                    var credits = {
                        enabled: false
                    };

                    var series = [{
                        name: '测量数量',
                        data: buhegedata1,
                        color: '#92A9D0',

                    }, {
                        name: '合格数量',
                        data: hegedata1,
                        color: '#4370A7',

                    }];
                    var legend = {
                        itemDistance: 200,
                        symbolWidth: 20,
                        symbolHeight: 20,
                        itemStyle: {
                            fontFamily: '微软雅黑',
                            color: '#C9C9CE',
                            fontSize: '25',
                            fontWeight: 'bold'
                        },
                        y: 10
                    }

                    var json = {};
                    json.chart = chart;
                    json.title = title;
                    json.legend = legend;
                    json.tooltip = tooltip;
                    json.xAxis = xAxis;
                    json.yAxis = yAxis;
                    json.series = series;
                    json.plotOptions = plotOptions;
                    json.credits = credits;
                    $('.containers6').highcharts(json);
                };
                var index = 0;
                //5秒轮播一次
                //var timer = setInterval(function () {
                //    var length = 0;
                //    $(".ProductKB").each(function () {
                //        length += 1;
                //    })
                //    if (index >= length - 1) {
                //        index = 0
                //        setInterval(window.location.href = '/Submit/SubmitProductPage', 2000)
                //    } else {
                //        index = index + 1;
                //    }
                //    //某个div显示，其他的隐藏
                //    $(".ProductKB").hide()

                //    setTimeout(function () {
                //        $(".ProductKB").eq(index).show();
                //        var count = index + 1;
                //        if (count == 1) {
                //            $(".container1").highcharts().reflow();
                //            $(".containers1").highcharts().reflow();
                //            $(".container2").highcharts().reflow();
                //            $(".containers2").highcharts().reflow();
                //            $(".container3").highcharts().reflow();
                //            $(".containers3").highcharts().reflow();
                //        } else {
                //            count += 2;
                //            $(".container" + count + "").highcharts().reflow();
                //            $(".containers" + count + "").highcharts().reflow();
                //        }


                //    }, 500);

                //}, 1000 * 5);

                //setInterval("location.reload();", 1000 * 60 * 1);//十分钟刷新整个页面
            })

        </script>
        <style type="text/css">
        
        </style>
    </head>
    <body >
       <div id="Main" style="background:url(../../Images/Submit/检具背景.png)no-repeat 12%;  background-size:100% 100%;">
           <div id="title" style="width:100%;height:5%;background:url(../../Images/Submit/顶部.jpg)no-repeat 12%;background-size:100% " > 
               <div style="background:url(../../Images/Submit/logo.png)no-repeat 12%;width:70%;height:98%;margin-left:30%">
                   <label style="font-size:30px;color:white;margin-left:16%"> 质量部检具室可视化管控平台</label>
               </div>
               
           </div>
           <div id="conter" style="width:100%;height:96%">
               <div id="left" style="width:25%; height:100%;float:left">
                   @* 时间日期栏 *@
                      <div id="time" style="background:url(../../Images/Submit/右上角图片.png)no-repeat  0%; height:15%;background-size:100% 100%;margin-top:3%">
                          <div style="height:35%;width:35%">
                               <div style="padding-top: 5%;">
                              <label style="font-size:25px;color:#C9C9CE;margin-left:25%;padding-top:1%;">时间日期</label>
                                   </div>
                          </div>
                          <div id="year" style="font-size:24px;color:#657B97;margin-left:2%;margin-top:6%;float:left"> </div>
                          <div id="hours" style="font-size:45px;color:#C9C9CE;margin-left:48%;float:left;margin-top:-12%;"> </div>
               </div>
                   @* 环境数据栏 *@
              <div id="" style="background:url(../../Images/Submit/环境数据.png)no-repeat  0%; height:20%;margin-top:2%;background-size:100% 100%;">
                     <div style="background:url(../../Images/Submit/时间框.png);height:20%;width:35%">
                             <div style="padding-top: 5%;">
                              <label style="font-size:25px;color:#C9C9CE;margin-left:25%;padding-top:1%;">环境数据</label>
                                   </div>
                          </div>    
                   <div style=" height:76%;width:35%;background-size:85% 95%;font-size:xxx-large;float:left;">
                         <div style="float:left;width:40%;height:100%;"> </div>
                       <div style="float:left; height:100%;width:50%;margin-top: 14%;">
                           <label id="Temperature" style="font-size:25px;color:#C9C9CE;margin-left:70%"></label>
                       </div>
                       
                   </div>
                   <div style="height:76%;width:50%;background-size:96% 97%;font-size:xxx-large;float:left;margin-left:15%">
                       <div style="float:left;width:50%;height:100%;"> </div>
                       <div style="float:left; height:100%;width:50%;margin-top: 10%;">
                       <label id="Humidity" style="font-size:25px;color:#C9C9CE;margin-left:15%;margin-top: 14%;"></label>
                       </div>
                   </div>
              </div>
                    @* 当班日期栏 *@
              <div id="" style="background:url(../../Images/Submit/左下角图片.png)no-repeat  0%; height:58%;margin-top:2%;background-size:100% 100%;">
                   <div style="background:url(../../Images/Submit/时间框.png);height:5%;width:35%">
                       <div style="padding-top: 5%;">
                            <label style="font-size:25px;color:#C9C9CE;margin-left:25%">当班信息</label>
                       </div>
                             
                          </div>   
                  <div id="shift" style="font-size:50px;color:#C9C9CE;margin-left:60%;margin-top:0%;"></div>
                  <div id="images" style="width:95%;height:85%;margin-top:8%;">
                      <table style="font-size:30px;color:white;text-align:center;vertical-align:middle;width: 100%;height: 90%;" >
                          <tr style="width:100%">
                              <td style="width:50%"><img id="imgMonitor"   style="height:99%;width:97%;"/></td>
                              <td style="width:50%"><img id="imgMeasure" style="height:99%;width:97%;margin-left:10%"/></td>
                          </tr>
                           <tr>
                              <td id="MonitorName" style="color:#657B97;"></td>
                              <td id="MeasureName" style="color:#657B97;"></td>
                          </tr>
                           <tr>
                              <td id="Monitor" style="color:#C9C9CE;"></td>
                              <td id="Measure" style="color:#C9C9CE;"></td>
                          </tr>
                      </table>

                  </div>
              </div>
           </div>
                <div id="rigth" style="background:url(../../Images/Submit/中间.png)no-repeat  1%; height:96%;width:74%;float:left;margin-left:1%;background-size:99% 99%">
                    <div id="TestTime" style="width:98%;text-align:center;font-size:35px;color:#C9C9CE;margin-top:1%;"></div>
                    <div class="ProductKB" style="width:100%;height:95%;margin-top:3%">
                         <div class="" style="height:30%">
                        <div class="container1"  style="width: 30%; height: 99%; margin: 0 0;border:1px;margin-left:1%;float:left;margin-top:-3%">

                    </div>
                      <div class="containers1"  style="width:68%; height: 99%; border:1px;float:left">

                    </div>
                  </div>
                       <div class="" style="height:30%">
                        <div class="container2"  style="width: 30%; height: 98%; margin: 0 0;border:1px;margin-left:1%;float:left;margin-top:-3%">

                    </div>
                      <div class="containers2"  style="width: 68%; height: 98%; border:1px;float:left">

                    </div>
                  </div>
                       <div class=""style="height:30%">
                        <div class="container3"  style="width: 30%; height: 98%; margin: 0 0;border:1px;margin-left:1%;float:left;margin-top:-3%">

                    </div>
                      <div class="containers3"  style="width: 68%; height: 98%; border:1px;float:left">

                    </div>
                  </div>
                    </div>
                  <div class="ProductKB" style="">
                        <div class ="container4"  style="width: 35%; height: 96%; margin: 0 0;border:1px;margin-left:1%;">

                    </div>
                      <div class="containers4"  style="width:99%; height: 96%; border:1px;float:left;margin-top: -3%;">

                    </div>
                  </div>
                       <div class="ProductKB" style="">
                        <div class="container5"  style="width: 35%; height: 96%; margin: 0 0;border:1px;margin-left:1%;">

                    </div>
                      <div class="containers5"  style="width: 99%; height: 96%; border:1px;float:left;margin-top: -3%;">

                    </div>
                  </div>
                       <div class="ProductKB"style="">
                        <div class="container6"  style="width: 35%; height: 96%; margin: 0 0;border:1px;margin-left:1%;">

                    </div>
                      <div class="containers6"  style="width: 99%; height: 96%; border:1px;float:left;margin-top: -3%;">

                    </div>
                  </div>
                </div>

           </div>
       </div>

    </body>

</html>