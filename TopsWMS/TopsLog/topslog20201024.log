
**************************************************************************************************************------>2020/10/24 15:49:48
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:49:48
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:49:58
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:49:58
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:16
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:16
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:16
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:16
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:16
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:19
类型：Query 查询对象：SelBoardModule 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select s_ModuleID,s_ModuleName,s_Url from tModule where s_ModuleName like '%看板%' and n_IsLeaf = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:20
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:20
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:20
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:21
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:21
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:21
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:21
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:21
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:22
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:50:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:51:05
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:51:11
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:51:11
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:51:11
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 15:51:11
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:08:38
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @:UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:08:38
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and s_EncryptionCipher = @:Password and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:08:38
类型：Business 业务对象：UserToolsLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:12:05
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:12:05
类型：Query 查询对象：SelBoardModule 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select s_ModuleID,s_ModuleName,s_Url from tModule where s_ModuleName like '%看板%' and n_IsLeaf = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:02
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:02
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:02
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:02
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:03
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:03
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:05
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:05
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:13
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:13
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[1]：0.先删除相关的权限
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
   delete from tPower where n_Type=1
end
else
begin
   delete from tPower
   where s_PowerID in (
      select s_PowerID from tModulePower where s_ModuleID=@ModuleID
   )
   delete from tModulePower where s_ModuleID=@ModuleID
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:13
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：0.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:13
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：1.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:20:13
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：2.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList_ExcelData"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息(下载)"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:25:18
类型：Query 查询对象：SelAllSheet 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

SELECT name = tbs.name ,value = isnull(ds.value,'') 
FROM sysobjects tbs
LEFT JOIN sys.extended_properties ds ON ds.major_id=tbs.id and ds.minor_id=0 
WHERE  xtype='u' and tbs.name not like 'MSmerge_conflict%' order by tbs.name asc

--select name from sys.sysobjects  where xtype='u' order by name asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"SysParamId" DbType:"String" Value:"5"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:25:20
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:25:20
类型：Query 查询对象：SelAllColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

SELECT  表名 = CASE WHEN a.colorder=1 THEN d.name
                  ELSE ''
             END,表说明 = CASE WHEN a.colorder=1 THEN ISNULL(f.value,'')
                            ELSE ''
                       END,--字段序号 = a.colorder,
                       字段名 = a.name,
        --标识 = CASE WHEN COLUMNPROPERTY(a.id,a.name,'IsIdentity')=1 THEN '√' ELSE '×' END,
        主键 = CASE WHEN EXISTS ( SELECT  1
                                FROM    sysobjects
                                WHERE   xtype='PK'
                                        AND name IN (
                                        SELECT  name
                                        FROM    sysindexes
                                        WHERE   indid IN (
                                                SELECT  indid
                                                FROM    sysindexkeys
                                                WHERE   id=a.id
                                                        AND colid=a.colid)) )
                  THEN '√'
                  ELSE ''
             END,
             类型 = b.name,--占用字节数 = a.length,
        长度 = COLUMNPROPERTY(a.id,a.name,'PRECISION'),
        --小数位数 = ISNULL(COLUMNPROPERTY(a.id,a.name,'Scale'),0),
        允许空 = CASE WHEN a.isnullable=1 THEN '√'
                   ELSE ''
              END,默认值 = ISNULL(e.text,''),字段说明 = ISNULL(g.[value],'')
FROM    syscolumns a
LEFT   JOIN systypes b
        ON a.xusertype=b.xusertype
INNER   JOIN sysobjects d
        ON a.id=d.id
           AND d.xtype='U'
           AND d.name<>'dtproperties'
LEFT   JOIN syscomments e
        ON a.cdefault=e.id
LEFT   JOIN sys.extended_properties g
        ON a.id=g.major_id
           AND a.colid=g.minor_id
LEFT   JOIN sys.extended_properties f
        ON d.id=f.major_id
           AND f.minor_id=0 where d.name=(case isnull(@Sheet,'') when '' then d.name else @Sheet end)       --如果只查询指定表,加上此条件
ORDER   BY a.id,a.colorder
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Sheet" DbType:"AnsiString" Value:"IMRFIDDataIntermediate"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:17
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @:UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:17
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and s_EncryptionCipher = @:Password and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:17
类型：Business 业务对象：UserToolsLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:19
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:19
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:19
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:19
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:19
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 16:57:20
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:02:51
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:02:59
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[1]：0.先删除相关的权限
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
   delete from tPower where n_Type=1
end
else
begin
   delete from tPower
   where s_PowerID in (
      select s_PowerID from tModulePower where s_ModuleID=@ModuleID
   )
   delete from tModulePower where s_ModuleID=@ModuleID
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:03:00
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：0.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:03:00
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：1.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:03:00
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：2.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList_ExcelData"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息(下载)"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:03:00
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：3.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList_ExcelColumns"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息的列名(下载)"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:12:46
类型：Query 查询对象：SelAllSheet 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

SELECT name = tbs.name ,value = isnull(ds.value,'') 
FROM sysobjects tbs
LEFT JOIN sys.extended_properties ds ON ds.major_id=tbs.id and ds.minor_id=0 
WHERE  xtype='u' and tbs.name not like 'MSmerge_conflict%' order by tbs.name asc

--select name from sys.sysobjects  where xtype='u' order by name asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"SysParamId" DbType:"String" Value:"5"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:12:50
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:12:50
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:28
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:29
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:29
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:36
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:36
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:36
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:37
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:37
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:37
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:38
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:48
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:48
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:53
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:53
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:13:53
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:01
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:10
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:10
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:10
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:21
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:30
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:30
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:30
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:30
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:38
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:38
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:14:38
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:15:58
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:00
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:09
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:26
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:26
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:27
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:16:58
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:17:05
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:25
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:31
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:45
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:45
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:45
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:20:46
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:08
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:10
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:10
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:14
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:28
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:29
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:29
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:29
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:21:56
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:22:10
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:26
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:36
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:48
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:52
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:23:58
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:05
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:20
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:29
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:29
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:29
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:29
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:35
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:38
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:24:40
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:40
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:48
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:50
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:52
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:25:54
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:31
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:31
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:31
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:32
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:44
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:55
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:55
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:55
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:26:58
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:27:02
类型：Query 查询对象：SelStockInOutRecordList_ExcelColumns 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 1,'货物标识编码',15
union all
select 2,'货物产品名称',25
union all
select 3,'货物产品编码',15
union all
select 4,'U9工件编码',15
union all
select 5,'U9工件名称',25
union all
select 6,'APQP阶段',15
union all
select 7,'质量合格',15
union all
select 8,'规格型号',15
union all
select 9,'单位',15
union all
select 10,'车型',15
union all
select 11,'颜色',15
union all
select 12,'批次号',15
union all
select 13,'入库时间',25
union all
select 14,'入库数量',15
union all
select 15,'入库良品数',15
union all
select 16,'入库不良品数',15
union all
select 17,'入库返工数',15
union all
select 18,'入库操作人',15
union all
select 19,'入库原因',25
union all
select 20,'入库次数序数',15
union all
select 21,'出库时间',25
union all
select 22,'出库数量',15
union all
select 23,'出库良品数',15
union all
select 24,'出库不良品数',15
union all
select 25,'出库返工数',15
union all
select 26,'出库操作人',15
union all
select 27,'出库原因',25
union all
select 28,'出库次数序数',15
union all
select 29,'是否已提交',15
union all
select 30,'状态',15 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/24 17:27:14
类型：Query 查询对象：SelStockInOutRecordList_ExcelData 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
 SELECT  
      [s_BillStockInOut_Code] 
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN] 
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]  
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses] 
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence] 
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
       
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"String" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"String" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"String" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"String" Value:"1"
（4）ParameterName:"@_txt_val" DbType:"String" Value:","
（5）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"String" Value:"0"
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^