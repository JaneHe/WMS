
**************************************************************************************************************------>2020/10/23 9:25:51
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:25:51
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:25:56
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:25:56
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:25
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:25
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:25
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:26
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:26
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:26
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:28
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:29
类型：Query 查询对象：SelBoardModule 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select s_ModuleID,s_ModuleName,s_Url from tModule where s_ModuleName like '%看板%' and n_IsLeaf = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:31
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:31
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:31
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:31
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:31
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:32
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:32
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:32
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:26:53
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:36:42
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:36:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:36:47
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:36:47
类型：Query 查询对象：SelBillStockInOutList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_BillStockInOut_CreateTime desc),* from (
SELECT 
--[Columns]
      [n_BillStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_Rack_Id]
      ,[n_Space_Id]
      ,[n_CombinedSpace_Id]
      ,[n_SplitSpace_Id]
      ,[n_Bin_Id]
      ,[n_ReportInventoryCurrent_Id]
      ,[s_BillStockInOut_BarCode]
      ,[s_BillStockInOut_ExternalCode]
      ,[s_BillStockInOut_ExternalName]
      ,[s_BillStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,(case [n_BillStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end) as [n_BillStockInOut_QualityStatus]
      ,[s_BillStockInOut_Operator]
      ,[s_BillStockInOut_Department]
      ,(case [s_BillStockInOut_Team] when 1 then '白班'
      when 2 then '夜班' else '' end) as [s_BillStockInOut_Team]
      ,Convert(varchar(20),[d_BillStockInOut_OperateTime],120) as [d_BillStockInOut_OperateTime]
      ,[s_BillStockInOut_Remark]
      ,[s_BillStockInOut_WhetherToSubmit]=(case s_BillStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[f_BillStockInOut_WorkOrderQuantity]
      ,[f_BillStockInOut_OKProductCou]
      ,[f_BillStockInOut_UnOKProductCou]
      ,[f_BillStockInOut_ReworkProductCou]
      ,[s_BillStockInOut_CustomFields1]
      ,[s_BillStockInOut_CustomFields2]
      ,[s_BillStockInOut_CustomFields3]
      ,[s_BillStockInOut_CustomFields4]
      ,[s_BillStockInOut_CustomFields5]
      ,[s_BillStockInOut_CustomFields6]
      ,[s_BillStockInOut_CustomFields7]
      ,[s_BillStockInOut_CustomFields8]
      ,[s_BillStockInOut_CustomFields9]
      ,[s_BillStockInOut_CustomFields10]
      ,[n_BillStockInOut_state]=(case n_BillStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_BillStockInOut_Creator]
      ,[d_BillStockInOut_CreateTime]
      ,[s_BillStockInOut_Updator]
      ,[d_BillStockInOut_UpdateTime]
--[/Columns]
  FROM [tBillStockInOut] with(nolock)
  where d_BillStockInOut_OperateTime >= (case isnull(@BeginTime,'') when '' then d_BillStockInOut_OperateTime else @BeginTime end)
  and d_BillStockInOut_OperateTime <= (case isnull(@EndTime,'') when '' then d_BillStockInOut_OperateTime else @EndTime end)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_BillStockInOut_BarCode] like (case when ISNULL(@s_BillStockInOut_BarCode,'') = ''
  then [s_BillStockInOut_BarCode] else '%'+@s_BillStockInOut_BarCode+'%' end)
  and s_BillStockInOut_ExternalCode like (case when ISNULL(@s_BillStockInOut_ExternalCode,'') = ''
  then s_BillStockInOut_ExternalCode else '%'+@s_BillStockInOut_ExternalCode+'%' end)
  and s_BillStockInOut_ExternalName like (case when ISNULL(@s_BillStockInOut_ExternalName,'') = ''
  then s_BillStockInOut_ExternalName else '%'+@s_BillStockInOut_ExternalName+'%' end)
  and n_BillStockInOut_state = (case isnull(@n_BillStockInOut_state,0) when 0
  then n_BillStockInOut_state else @n_BillStockInOut_state end)
  --and [s_BillStockInOut_WhetherToSubmit] = (case isnull(@s_BillStockInOut_WhetherToSubmit,0) when 0
  --then [s_BillStockInOut_WhetherToSubmit] else @s_BillStockInOut_WhetherToSubmit end)
  and [n_Space_Id] = '031B53F3-5EB8-4A5C-91DC-09EE2158BAC9'
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@BeginTime" DbType:"DateTime" Value:"2020/10/23 0:00:00"
（1）ParameterName:"@EndTime" DbType:"DateTime" Value:"9999/12/31 23:59:59"
（2）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（3）ParameterName:"@s_BillStockInOut_BarCode" DbType:"AnsiString" Value:""
（4）ParameterName:"@s_BillStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（5）ParameterName:"@s_BillStockInOut_ExternalName" DbType:"AnsiString" Value:""
（6）ParameterName:"@n_BillStockInOut_state" DbType:"Int32" Value:"1"
（7）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（8）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（9）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（10）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:36:47
类型：Query 查询对象：SelBillStockInOutList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [tBillStockInOut] with(nolock)
  where d_BillStockInOut_OperateTime >= (case isnull(@BeginTime,'') when '' then d_BillStockInOut_OperateTime else @BeginTime end)
  and d_BillStockInOut_OperateTime <= (case isnull(@EndTime,'') when '' then d_BillStockInOut_OperateTime else @EndTime end)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_BillStockInOut_BarCode] like (case when ISNULL(@s_BillStockInOut_BarCode,'') = ''
  then [s_BillStockInOut_BarCode] else '%'+@s_BillStockInOut_BarCode+'%' end)
  and s_BillStockInOut_ExternalCode like (case when ISNULL(@s_BillStockInOut_ExternalCode,'') = ''
  then s_BillStockInOut_ExternalCode else '%'+@s_BillStockInOut_ExternalCode+'%' end)
  and s_BillStockInOut_ExternalName like (case when ISNULL(@s_BillStockInOut_ExternalName,'') = ''
  then s_BillStockInOut_ExternalName else '%'+@s_BillStockInOut_ExternalName+'%' end)
  and n_BillStockInOut_state = (case isnull(@n_BillStockInOut_state,0) when 0
  then n_BillStockInOut_state else @n_BillStockInOut_state end)
  --and [s_BillStockInOut_WhetherToSubmit] = (case isnull(@s_BillStockInOut_WhetherToSubmit,0) when 0
  --then [s_BillStockInOut_WhetherToSubmit] else @s_BillStockInOut_WhetherToSubmit end)
  and [n_Space_Id] = '031B53F3-5EB8-4A5C-91DC-09EE2158BAC9'
 ) T_RowsCount 




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@BeginTime" DbType:"DateTime" Value:"2020/10/23 0:00:00"
（1）ParameterName:"@EndTime" DbType:"DateTime" Value:"9999/12/31 23:59:59"
（2）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（3）ParameterName:"@s_BillStockInOut_BarCode" DbType:"AnsiString" Value:""
（4）ParameterName:"@s_BillStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（5）ParameterName:"@s_BillStockInOut_ExternalName" DbType:"AnsiString" Value:""
（6）ParameterName:"@n_BillStockInOut_state" DbType:"Int32" Value:"1"
（7）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（8）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（9）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（10）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:37:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:37:10
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:37:10
类型：Query 查询对象：SelBillStockInOutList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_BillStockInOut_CreateTime desc),* from (
SELECT 
--[Columns]
      [n_BillStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_Rack_Id]
      ,[n_Space_Id]
      ,[n_CombinedSpace_Id]
      ,[n_SplitSpace_Id]
      ,[n_Bin_Id]
      ,[n_ReportInventoryCurrent_Id]
      ,[s_BillStockInOut_BarCode]
      ,[s_BillStockInOut_ExternalCode]
      ,[s_BillStockInOut_ExternalName]
      ,[s_BillStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,(case [n_BillStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end) as [n_BillStockInOut_QualityStatus]
      ,[s_BillStockInOut_Operator]
      ,[s_BillStockInOut_Department]
      ,(case [s_BillStockInOut_Team] when 1 then '白班'
      when 2 then '夜班' else '' end) as [s_BillStockInOut_Team]
      ,Convert(varchar(20),[d_BillStockInOut_OperateTime],120) as [d_BillStockInOut_OperateTime]
      ,[s_BillStockInOut_Remark]
      ,[s_BillStockInOut_WhetherToSubmit]=(case s_BillStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[f_BillStockInOut_WorkOrderQuantity]
      ,[f_BillStockInOut_OKProductCou]
      ,[f_BillStockInOut_UnOKProductCou]
      ,[f_BillStockInOut_ReworkProductCou]
      ,[s_BillStockInOut_CustomFields1]
      ,[s_BillStockInOut_CustomFields2]
      ,[s_BillStockInOut_CustomFields3]
      ,[s_BillStockInOut_CustomFields4]
      ,[s_BillStockInOut_CustomFields5]
      ,[s_BillStockInOut_CustomFields6]
      ,[s_BillStockInOut_CustomFields7]
      ,[s_BillStockInOut_CustomFields8]
      ,[s_BillStockInOut_CustomFields9]
      ,[s_BillStockInOut_CustomFields10]
      ,[n_BillStockInOut_state]=(case n_BillStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_BillStockInOut_Creator]
      ,[d_BillStockInOut_CreateTime]
      ,[s_BillStockInOut_Updator]
      ,[d_BillStockInOut_UpdateTime]
--[/Columns]
  FROM [tBillStockInOut] with(nolock)
  where d_BillStockInOut_OperateTime >= (case isnull(@BeginTime,'') when '' then d_BillStockInOut_OperateTime else @BeginTime end)
  and d_BillStockInOut_OperateTime <= (case isnull(@EndTime,'') when '' then d_BillStockInOut_OperateTime else @EndTime end)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_BillStockInOut_BarCode] like (case when ISNULL(@s_BillStockInOut_BarCode,'') = ''
  then [s_BillStockInOut_BarCode] else '%'+@s_BillStockInOut_BarCode+'%' end)
  and s_BillStockInOut_ExternalCode like (case when ISNULL(@s_BillStockInOut_ExternalCode,'') = ''
  then s_BillStockInOut_ExternalCode else '%'+@s_BillStockInOut_ExternalCode+'%' end)
  and s_BillStockInOut_ExternalName like (case when ISNULL(@s_BillStockInOut_ExternalName,'') = ''
  then s_BillStockInOut_ExternalName else '%'+@s_BillStockInOut_ExternalName+'%' end)
  and n_BillStockInOut_state = (case isnull(@n_BillStockInOut_state,0) when 0
  then n_BillStockInOut_state else @n_BillStockInOut_state end)
  --and [s_BillStockInOut_WhetherToSubmit] = (case isnull(@s_BillStockInOut_WhetherToSubmit,0) when 0
  --then [s_BillStockInOut_WhetherToSubmit] else @s_BillStockInOut_WhetherToSubmit end)
  and [n_Space_Id] = '031B53F3-5EB8-4A5C-91DC-09EE2158BAC9'
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@BeginTime" DbType:"DateTime" Value:"2020/10/23 0:00:00"
（1）ParameterName:"@EndTime" DbType:"DateTime" Value:"9999/12/31 23:59:59"
（2）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（3）ParameterName:"@s_BillStockInOut_BarCode" DbType:"AnsiString" Value:""
（4）ParameterName:"@s_BillStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（5）ParameterName:"@s_BillStockInOut_ExternalName" DbType:"AnsiString" Value:""
（6）ParameterName:"@n_BillStockInOut_state" DbType:"Int32" Value:"1"
（7）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（8）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（9）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（10）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 9:37:10
类型：Query 查询对象：SelBillStockInOutList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [tBillStockInOut] with(nolock)
  where d_BillStockInOut_OperateTime >= (case isnull(@BeginTime,'') when '' then d_BillStockInOut_OperateTime else @BeginTime end)
  and d_BillStockInOut_OperateTime <= (case isnull(@EndTime,'') when '' then d_BillStockInOut_OperateTime else @EndTime end)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_BillStockInOut_BarCode] like (case when ISNULL(@s_BillStockInOut_BarCode,'') = ''
  then [s_BillStockInOut_BarCode] else '%'+@s_BillStockInOut_BarCode+'%' end)
  and s_BillStockInOut_ExternalCode like (case when ISNULL(@s_BillStockInOut_ExternalCode,'') = ''
  then s_BillStockInOut_ExternalCode else '%'+@s_BillStockInOut_ExternalCode+'%' end)
  and s_BillStockInOut_ExternalName like (case when ISNULL(@s_BillStockInOut_ExternalName,'') = ''
  then s_BillStockInOut_ExternalName else '%'+@s_BillStockInOut_ExternalName+'%' end)
  and n_BillStockInOut_state = (case isnull(@n_BillStockInOut_state,0) when 0
  then n_BillStockInOut_state else @n_BillStockInOut_state end)
  --and [s_BillStockInOut_WhetherToSubmit] = (case isnull(@s_BillStockInOut_WhetherToSubmit,0) when 0
  --then [s_BillStockInOut_WhetherToSubmit] else @s_BillStockInOut_WhetherToSubmit end)
  and [n_Space_Id] = '031B53F3-5EB8-4A5C-91DC-09EE2158BAC9'
 ) T_RowsCount 




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@BeginTime" DbType:"DateTime" Value:"2020/10/23 0:00:00"
（1）ParameterName:"@EndTime" DbType:"DateTime" Value:"9999/12/31 23:59:59"
（2）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（3）ParameterName:"@s_BillStockInOut_BarCode" DbType:"AnsiString" Value:""
（4）ParameterName:"@s_BillStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（5）ParameterName:"@s_BillStockInOut_ExternalName" DbType:"AnsiString" Value:""
（6）ParameterName:"@n_BillStockInOut_state" DbType:"Int32" Value:"1"
（7）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（8）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（9）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（10）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:17
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:18
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:26
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:26
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:26
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:27
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:27:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 10:28:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:52:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:52:56
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:09
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @:UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:09
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and s_EncryptionCipher = @:Password and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:09
类型：Business 业务对象：UserToolsLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:25
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:25
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:25
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:25
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:53:26
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:07
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:08
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:10
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:10
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:17
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:17
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:17
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:17
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:25
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:25
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:57:25
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010203"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:07
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:07
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:07
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010203"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:17
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 13:58:17
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202010012"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010203"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:01:52
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:19
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:19
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:19
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:23
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:24
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:24
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040028"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:46
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:46
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:02:46
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:13
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:22
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:22
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:27
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:27
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:35
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:36
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:03:36
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:04:03
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:04:03
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:04:03
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202010012"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:04:26
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:03
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:03
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:04
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:08
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:08
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:08
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040025"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:20
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:20
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:20
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:49
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:53
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:54
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:05:54
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:00
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:00
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:00
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:07
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:07
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:06:07
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:48
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @:UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:48
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and s_EncryptionCipher = @:Password and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:48
类型：Business 业务对象：UserToolsLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:49
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:32:51
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:01
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:02
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:03
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:03
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:08
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:08
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:08
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:08
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:36:10
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:37:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:38:43
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:38:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 14:39:06
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:07:58
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:48
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:49
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:49
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:55
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:08:55
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040025"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:14
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:14
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:14
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202010012"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:46
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:47
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:09:47
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max) 
declare @n_BillStockInOutDetail_Id varchar(max)

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]
           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]
           ,[n_LaunchReason_Name]
           ,[n_ListPutOnOff_LaunchType]
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
		   ,@n_Rack_Id
		   ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
		   ,@n_ListPutOnOff_GoodsProductId
		   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
		   ,@s_ListPutOnOff_SpecificationAndModel
		   ,@s_ListPutOnOff_Unit
		   ,@s_ListPutOnOff_Model
		   ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
		   ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
		   ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id
           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@n_Space_Id" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2986B953-20B8-411B-AA45-F682F8004430"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202010012"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"V212右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"222"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:10:31
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:10:31
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:10:31
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]
           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]
           ,[n_LaunchReason_Name]
           ,[n_ListPutOnOff_LaunchType]
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
		   ,@n_Rack_Id
		   ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
		   ,@n_ListPutOnOff_GoodsProductId
		   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
		   ,@s_ListPutOnOff_SpecificationAndModel
		   ,@s_ListPutOnOff_Unit
		   ,@s_ListPutOnOff_Model
		   ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
		   ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
		   ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id
           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@n_Space_Id" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2986B953-20B8-411B-AA45-F682F8004430"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202010012"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"V212右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"222"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:14:36
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:14:37
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:14:37
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@n_Space_Id" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2986B953-20B8-411B-AA45-F682F8004430"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202010012"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"V212右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"222"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:14:37
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：1.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@n_Space_Id" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"A6DA43B9-6AF6-4BAA-8A25-7C4901077694"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040025"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"111"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:21:04
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:21:28
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:22:53
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:06
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:06
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:06
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:13
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:13
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:23:13
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:27:12
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:27:13
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:27:13
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040027"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:29:45
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:29:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:29:58
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:29:58
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:29:58
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:00
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:00
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:05
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:07
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:07
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040028"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:27
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:27
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:36
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:37
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:37
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040025"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:45
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:50
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:30:50
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040027"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:31:50
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:31:53
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:31:53
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:31:53
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:02
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:09
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:09
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:10
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:11
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:32:11
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:33:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:33:55
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:33:56
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:34:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:34:58
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:34:59
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:34:59
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:07
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:07
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:07
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:18
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:19
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:19
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040027"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:33
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:34
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:34
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:47
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:48
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"65EE90C4-08DC-43CC-AF54-B454940B09D7"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1211010008"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"L541左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"40"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"9999"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:48
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：1.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"F8F9F54D-3167-433F-A4D1-55AB82AB5F1B"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040027"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"30"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"3333"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:35:48
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：2.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2DBAC516-5E72-4AA9-BD61-177319727E28"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040030"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"AnsiString" Value:"null"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:38
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:42
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:43
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:43
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:48
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:48
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:48
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:56
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:57
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:49:57
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040025"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:50:59
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:00
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:00
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:10
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:10
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:10
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202010012"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:22
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:25
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:26
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:52
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:52
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:53
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"65EE90C4-08DC-43CC-AF54-B454940B09D7"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1211010008"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"L541左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"40"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"8888"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:53
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：1.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2986B953-20B8-411B-AA45-F682F8004430"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202010012"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"V212右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"30"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"8888"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:51:53
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：2.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2DBAC516-5E72-4AA9-BD61-177319727E28"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040030"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:02
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:06
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:06
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:06
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:16
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:16
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:16
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:36
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:39
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:39
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:39
类型：Query 查询对象：SelPutOnOffQrCodeInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select 
n_Space_Id,
s_Space_BarCode,
tWarehouse.s_Warehouse_Name+'的第'+s_Rack_Code+'排第'+ Convert(varchar(20),n_Space_BayNumber)+'节第'+ Convert(varchar(20),n_Space_LayerNumber) +'层' as s_Space_Description

from tSpace tSpace with(nolock)
inner join tWarehouse tWarehouse with(nolock) on tSpace.n_Warehouse_Id = tWarehouse.n_Warehouse_Id
inner join tRack tRack with(nolock) on tRack.n_Rack_Id = tSpace.n_Rack_Id
where s_Space_BarCode = @s_Space_BarCode  and tWarehouse.n_Warehouse_state = 1
and tRack.n_Rack_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:51
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:51
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:57:51
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040030"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:09
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:10
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:10
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1202040027"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:39
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:39
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 15:58:39
类型：Query 查询对象：SelPutOnOffWorkOrderInfo 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
declare @n_Warehouse_Id varchar(max)
select @n_Warehouse_Id = n_Warehouse_Id from tSpace with(nolock) where s_Space_BarCode = @s_Space_BarCode

--根据入库单去适配是不是符合上架要求的
SELECT [n_BillStockInOutDetail_Id] as n_BillStockInOutDetail_Id
      ,tBillStockInOutDetail.[n_Warehouse_Id] as n_Warehouse_Id
      ,tBillStockInOutDetail.[n_BillStockInOut_Id] as n_BillStockInOut_Id
      ,[s_BillStockInOutDetail_BarCode] as s_BillStockInOutDetail_BarCode
      ,s_BillStockInOutDetail_ExternalCode as s_BillStockInOutDetail_GoodsProductCode
      ,s_BillStockInOutDetail_ExternalName as s_BillStockInOutDetail_GoodsProductName 
      ,[d_BillStockInOutDetail_OperateTime] as d_BillStockInOutDetail_OperateTime
      ,[f_BillStockInOutDetail_WorkOrderQuantity] as f_BillStockInOutDetail_WorkOrderQuantity
  FROM [TopsWMS_BIZ].[dbo].[tBillStockInOut] tBillStockInOut with(nolock)
  inner join tBillStockInOutDetail tBillStockInOutDetail with(nolock) on tBillStockInOutDetail.n_BillStockInOut_Id = tBillStockInOut.n_BillStockInOut_Id
where [n_BillStockInOut_state] = 1
and [n_BillStockInOutDetail_state] = 1 and isnull(n_BillStockInOutDetail_IsFinishedState,0) not in (2,4)
and s_BillStockInOutDetail_ExternalCode = @s_BillStockInOutDetail_GoodsProductCode
and tBillStockInOut.n_Warehouse_Id = @n_Warehouse_Id
and isnull(tBillStockInOutDetail.n_BillStockInOutDetail_IsApproved,0) = 0 
order by d_BillStockInOutDetail_OperateTime asc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOutDetail_GoodsProductCode" DbType:"AnsiString" Value:"1211010008"
（1）ParameterName:"@s_Space_BarCode" DbType:"AnsiString" Value:"CS010401"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:00:19
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:00:19
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:00:20
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：0.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"65EE90C4-08DC-43CC-AF54-B454940B09D7"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1211010008"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"L541左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"0"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"666666"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:00:20
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：1.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"F8F9F54D-3167-433F-A4D1-55AB82AB5F1B"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040027"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG左门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"50"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"99999"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:00:20
类型：Business 业务对象：InsertPutOnOffListStockInOut 
说明：执行业务过程[1]：2.新增上架操作记录
***************************************************************************************************************
SQL:
 
--当前时间
declare @NowDate varchar(20) = replace(replace(replace(replace(Convert(varchar(30),getdate(),121),'-',''),':',''),' ',''),'.','')

--查询相关的仓库信息ID,车间信息ID,货架信息ID
declare @n_Warehouse_Id varchar(max)
declare @n_Shopfloor_Id varchar(max)
declare @n_Rack_Id varchar(max)
select top 1 
@n_Shopfloor_Id = n_Shopfloor_Id, 
@n_Warehouse_Id = n_Warehouse_Id,
@n_Rack_Id = n_Rack_Id 
from tSpace with(nolock) where n_Space_Id = @n_Space_Id
and n_Space_state = 1

--班次
declare @s_ListStockInOut_Team varchar(50) = (select dbo.function_GetTeamByNowDate(getdate()))
select @s_ListStockInOut_Team


--查询与之关联的入库单信息的ID与编码,入库单明细信息ID
declare @n_BillStockInOut_Id varchar(max)
declare @s_BillStockInOut_Code varchar(max)  

select 
@n_BillStockInOut_Id = n_BillStockInOut_Id,
@s_BillStockInOut_Code = s_BillStockInOutDetail_Code,
@n_BillStockInOutDetail_Id = n_BillStockInOutDetail_Id
 from tBillStockInOutDetail with(nolock)
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id


--查询出货物标识基础表外键ID
declare @n_ListPutOnOff_GoodsProductId varchar(max) = (select dbo.function_GetGoodsIdbyGoodsCode(@s_ListPutOnOff_GoodsProductCode))

--从存货管理表取出规格，型号，颜色等信息
declare @s_ListPutOnOff_SpecificationAndModel varchar(max)
declare @s_ListPutOnOff_Unit varchar(max)
declare @s_ListPutOnOff_Model varchar(max)
declare @s_ListPutOnOff_Color varchar(max)

select top 1
@s_ListPutOnOff_SpecificationAndModel = s_PartDescription_SpecificationAndModel,
@s_ListPutOnOff_Unit = s_PartDescription_Unit,
@s_ListPutOnOff_Model = s_PartDescription_Model,
@s_ListPutOnOff_Color = s_PartDescription_Color 
from tPartDescription with(nolock)
where s_PartDescription_Code = @s_ListPutOnOff_GoodsProductCode
and n_PartDescription_state = 1

--修正入库单明细的完成状态
update tBillStockInOutDetail set n_BillStockInOutDetail_IsFinishedState = 2
where n_BillStockInOutDetail_Id = @n_BillStockInOutDetail_Id 

--上架次数序数
declare @n_ListPutOnOff_LaunchSequence int
set @n_ListPutOnOff_LaunchSequence =  isnull((
select top 1 n_ListPutOnOff_LaunchSequence from [tListPutOnOff] with(nolock) where s_BillStockInOut_Code = @s_BillStockInOut_Code and n_ListPutOnOff_state = 1),0) + 1

 
 INSERT INTO [dbo].[tListPutOnOff]
           ([n_ListPutOnOff_Id]
           ,[s_BillStockInOut_Code]
           ,[n_Warehouse_Id]
           ,[n_Shopfloor_Id]
           ,[n_Rack_Id]
           ,[n_Space_Id] 
           ,[n_ListStockInOut_Id]
           ,[n_BillStockInOutDetail_Id] 
           ,[n_ListPutOnOff_GoodsId]
           ,[s_ListPutOnOff_Code]
           ,[s_ListPutOnOff_GoodsProductName]
           ,[s_ListPutOnOff_GoodsProductCode]
           ,[n_ListPutOnOff_GoodsProductId]
           ,[s_ListPutOnOff_ExternalCode]
           ,[s_ListPutOnOff_ExternalName]
           ,[s_ListPutOnOff_ECN] 
           ,[n_APQPStatus_QualityStatus]
           ,[s_ListPutOnOff_SpecificationAndModel]
           ,[s_ListPutOnOff_Unit]
           ,[s_ListPutOnOff_Model]

           ,[s_ListPutOnOff_Color]
           ,[s_ListPutOnOff_BatchNumber]
           ,[d_ListPutOnOff_LaunchTime]
           ,[n_ListPutOnOff_LaunchNumber]
           ,[n_ListPutOnOff_LaunchOKProductCou]
           ,[n_ListPutOnOff_LaunchUnOKProductCou]
           ,[n_ListPutOnOff_LaunchReworkProductCou]
           ,[s_ListPutOnOff_LaunchOperator]
           ,[s_ListPutOnOff_LaunchClasses]
           ,[n_LaunchReason_Id]

           ,[n_LaunchReason_Name] 
           ,[n_ListPutOnOff_LaunchSequence] 
           ,[s_ListPutOnOff_WhetherToSubmit]
           ,[n_ListPutOnOff_state]
           ,[s_ListPutOnOff_Creator]
           ,[d_ListPutOnOff_CreateTime]
           ,[s_ListPutOnOff_Updator]
           ,[d_ListPutOnOff_UpdateTime])
     VALUES
           (newID()
           ,@s_BillStockInOut_Code
           ,@n_Warehouse_Id
           ,@n_Shopfloor_Id
          ,@n_Rack_Id
          ,@n_Space_Id  
           ,''
           ,@n_BillStockInOutDetail_Id 
           ,@n_ListPutOnOff_GoodsProductId
	   ,@s_ListPutOnOff_Code
           ,@s_ListPutOnOff_GoodsProductName
           ,@s_ListPutOnOff_GoodsProductCode
	 	   ,@n_ListPutOnOff_GoodsProductId
           ,@s_ListPutOnOff_GoodsProductCode
           ,@s_ListPutOnOff_GoodsProductName
           ,''
           ,1
          ,@s_ListPutOnOff_SpecificationAndModel
          ,@s_ListPutOnOff_Unit
          ,@s_ListPutOnOff_Model

           ,@s_ListPutOnOff_Color
           ,''
           ,getdate() 
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,@f_ListPutOnOff_WorkOrderQuantity
           ,0
           ,0
           ,@Operator
           ,(case when datepart(hour,getdate()) >= 8 and datepart(hour,getdate()) < 20 then 1 else 2 end)
           ,@n_LaunchReason_Id

           ,@s_LaunchReason_Name 
           ,@n_ListPutOnOff_LaunchSequence
           ,0
           ,1
           ,@Operator
           ,GETDATE()
           ,@Operator
           ,GETDATE())


^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@n_Space_Id" DbType:"String" Value:"1F7E7E44-A017-4A73-AF9A-85A9EF19D542"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@n_BillStockInOutDetail_Id" DbType:"String" Value:"2DBAC516-5E72-4AA9-BD61-177319727E28"
（4）ParameterName:"@s_ListPutOnOff_GoodsProductCode" DbType:"String" Value:"1202040030"
（5）ParameterName:"@s_ListPutOnOff_Code" DbType:"String" Value:"CS010401"
（6）ParameterName:"@s_ListPutOnOff_GoodsProductName" DbType:"String" Value:"W205 AMG右门槛油漆件"
（7）ParameterName:"@f_ListPutOnOff_WorkOrderQuantity" DbType:"String" Value:"20"
（8）ParameterName:"@n_LaunchReason_Id" DbType:"String" Value:""
（9）ParameterName:"@s_LaunchReason_Name" DbType:"String" Value:"3333"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:03:35
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:03:35
类型：Business 业务对象：Tool_AddModule 
说明：执行业务检查：1.*.模块ID已经存在
***************************************************************************************************************
SQL:
if not exists(
   select 1 from tModule where s_ModuleID=@:moduleID
)
select 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ComAddBiz" DbType:"AnsiString" Value:""
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ComDelBiz" DbType:"AnsiString" Value:""
（4）ParameterName:"@ComModifyBiz" DbType:"AnsiString" Value:""
（5）ParameterName:"@ComObjectName" DbType:"AnsiString" Value:""
（6）ParameterName:"@ComQueryName" DbType:"AnsiString" Value:""
（7）ParameterName:"@moduleHelper" DbType:"AnsiString" Value:""
（8）ParameterName:"@moduleIconUrl" DbType:"AnsiString" Value:""
（9）ParameterName:"@moduleID" DbType:"AnsiString" Value:"wms-kcgl"
（10）ParameterName:"@moduleIsCom" DbType:"Boolean" Value:"null"
（11）ParameterName:"@moduleIsLeaf" DbType:"Boolean" Value:"null"
（12）ParameterName:"@moduleName" DbType:"AnsiString" Value:"WMS-库存管理"
（13）ParameterName:"@moduleNo" DbType:"AnsiString" Value:""
（14）ParameterName:"@moduleStatus" DbType:"Int32" Value:"null"
（15）ParameterName:"@moduleUrl" DbType:"AnsiString" Value:""
（16）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:03:36
类型：Business 业务对象：Tool_AddModule 
说明：执行业务过程[1]：0.添加模块
***************************************************************************************************************
SQL:
INSERT INTO tModule
           (s_ModuleID
           ,s_ModuleName
           ,n_Tag
           ,s_ParentID
           ,s_Url
           ,s_IconUrl
           ,n_IsLeaf
           ,s_Helper
           ,n_No,
           b_IsCom,
    s_ComQueryName,
    s_ComObjectName,
    s_ComAddBiz,
    s_ComModifyBiz,
    s_ComDelBiz
)
     VALUES
           (
           @moduleID
           ,@moduleName
           ,isnull(@moduleStatus,0)
           ,@ParentID
           ,@moduleUrl
,@moduleIconUrl
           ,isnull(@moduleIsLeaf,0)
           ,@moduleHelper
           ,@moduleNo
 ,isnull(@moduleIsCom,0),
    @ComQueryName,
    @ComObjectName,
    @ComAddBiz,
    @ComModifyBiz,
    @ComDelBiz
)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ComAddBiz" DbType:"AnsiString" Value:""
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@ComDelBiz" DbType:"AnsiString" Value:""
（4）ParameterName:"@ComModifyBiz" DbType:"AnsiString" Value:""
（5）ParameterName:"@ComObjectName" DbType:"AnsiString" Value:""
（6）ParameterName:"@ComQueryName" DbType:"AnsiString" Value:""
（7）ParameterName:"@moduleHelper" DbType:"AnsiString" Value:""
（8）ParameterName:"@moduleIconUrl" DbType:"AnsiString" Value:""
（9）ParameterName:"@moduleID" DbType:"AnsiString" Value:"wms-kcgl"
（10）ParameterName:"@moduleIsCom" DbType:"Boolean" Value:""
（11）ParameterName:"@moduleIsLeaf" DbType:"Boolean" Value:""
（12）ParameterName:"@moduleName" DbType:"AnsiString" Value:"WMS-库存管理"
（13）ParameterName:"@moduleNo" DbType:"AnsiString" Value:""
（14）ParameterName:"@moduleStatus" DbType:"Int32" Value:""
（15）ParameterName:"@moduleUrl" DbType:"AnsiString" Value:""
（16）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:08:43
类型：Business 业务对象：Tool_AddModule 
说明：执行业务检查：1.*.模块ID已经存在
***************************************************************************************************************
SQL:
if not exists(
   select 1 from tModule where s_ModuleID=@:moduleID
)
select 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ComAddBiz" DbType:"AnsiString" Value:""
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ComDelBiz" DbType:"AnsiString" Value:""
（4）ParameterName:"@ComModifyBiz" DbType:"AnsiString" Value:""
（5）ParameterName:"@ComObjectName" DbType:"AnsiString" Value:""
（6）ParameterName:"@ComQueryName" DbType:"AnsiString" Value:""
（7）ParameterName:"@moduleHelper" DbType:"AnsiString" Value:""
（8）ParameterName:"@moduleIconUrl" DbType:"AnsiString" Value:""
（9）ParameterName:"@moduleID" DbType:"AnsiString" Value:"hwcrkjltj"
（10）ParameterName:"@moduleIsCom" DbType:"Boolean" Value:"null"
（11）ParameterName:"@moduleIsLeaf" DbType:"Boolean" Value:"True"
（12）ParameterName:"@moduleName" DbType:"AnsiString" Value:"货物出入库记录统计"
（13）ParameterName:"@moduleNo" DbType:"AnsiString" Value:""
（14）ParameterName:"@moduleStatus" DbType:"Int32" Value:"null"
（15）ParameterName:"@moduleUrl" DbType:"AnsiString" Value:"/StockInOutRecord/Index"
（16）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:08:43
类型：Business 业务对象：Tool_AddModule 
说明：执行业务过程[1]：0.添加模块
***************************************************************************************************************
SQL:
INSERT INTO tModule
           (s_ModuleID
           ,s_ModuleName
           ,n_Tag
           ,s_ParentID
           ,s_Url
           ,s_IconUrl
           ,n_IsLeaf
           ,s_Helper
           ,n_No,
           b_IsCom,
    s_ComQueryName,
    s_ComObjectName,
    s_ComAddBiz,
    s_ComModifyBiz,
    s_ComDelBiz
)
     VALUES
           (
           @moduleID
           ,@moduleName
           ,isnull(@moduleStatus,0)
           ,@ParentID
           ,@moduleUrl
,@moduleIconUrl
           ,isnull(@moduleIsLeaf,0)
           ,@moduleHelper
           ,@moduleNo
 ,isnull(@moduleIsCom,0),
    @ComQueryName,
    @ComObjectName,
    @ComAddBiz,
    @ComModifyBiz,
    @ComDelBiz
)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ComAddBiz" DbType:"AnsiString" Value:""
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ComDelBiz" DbType:"AnsiString" Value:""
（4）ParameterName:"@ComModifyBiz" DbType:"AnsiString" Value:""
（5）ParameterName:"@ComObjectName" DbType:"AnsiString" Value:""
（6）ParameterName:"@ComQueryName" DbType:"AnsiString" Value:""
（7）ParameterName:"@moduleHelper" DbType:"AnsiString" Value:""
（8）ParameterName:"@moduleIconUrl" DbType:"AnsiString" Value:""
（9）ParameterName:"@moduleID" DbType:"AnsiString" Value:"hwcrkjltj"
（10）ParameterName:"@moduleIsCom" DbType:"Boolean" Value:""
（11）ParameterName:"@moduleIsLeaf" DbType:"Boolean" Value:"True"
（12）ParameterName:"@moduleName" DbType:"AnsiString" Value:"货物出入库记录统计"
（13）ParameterName:"@moduleNo" DbType:"AnsiString" Value:""
（14）ParameterName:"@moduleStatus" DbType:"Int32" Value:""
（15）ParameterName:"@moduleUrl" DbType:"AnsiString" Value:"/StockInOutRecord/Index"
（16）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:17:12
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"zshcqjccgl"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:17:33
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @:UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:17:33
类型：Business 业务对象：UserToolsLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and s_EncryptionCipher = @:Password and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:17:33
类型：Business 业务对象：UserToolsLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from [TopsWMS_FRM].[dbo].[FRM_Developer] where s_UserNO = @UserNO and n_state = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"heweijian"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@Password" DbType:"AnsiString" Value:"F7D46DABEE7173DB"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:46
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"sjcz"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:55
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:55
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:55
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:55
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:55
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:20:56
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:21:26
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:03
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[1]：0.先删除相关的权限
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
   delete from tPower where n_Type=1
end
else
begin
   delete from tPower
   where s_PowerID in (
      select s_PowerID from tModulePower where s_ModuleID=@ModuleID
   )
   delete from tModulePower where s_ModuleID=@ModuleID
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:03
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：0.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（5）ParameterName:"@PowerName" DbType:"String" Value:"进入权限"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"2"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:03
类型：Business 业务对象：SaveModulePower 
说明：执行业务过程[2]：1.添加权限及添加模块权限关联
***************************************************************************************************************
SQL:
if @ModuleID='_Default_Role'
begin
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		1,
        isnull(@IsPublic,0)
	)
end
else
begin
   if not exists(select 1 from tModulePower with(nolock)
   where s_ModuleID=@ModuleID and s_PowerID=@PowerID)
   begin
   
    delete from tPower where s_PowerID=@PowerID
	insert into tPower (
		s_PowerID,
		s_PowerName,
		n_Type,
        b_IsPublic
	)values (
		@PowerID,
		@PowerName,
		@PowerType,
        isnull(@IsPublic,0)
	)
    delete from tModulePower where s_ModuleID=@ModuleID and s_PowerID=@PowerID
	insert into tModulePower (
		s_ModuleID,
		s_PowerID
	)values (
		@ModuleID,
		@PowerID
	)
	
	end
end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IsPublic" DbType:"Boolean" Value:"False"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:""
（3）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（4）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList"
（5）ParameterName:"@PowerName" DbType:"String" Value:"查询出入库记录信息"
（6）ParameterName:"@PowerType" DbType:"Int64" Value:"4"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:19
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:19
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:21
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:22
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:29
类型：Business 业务对象：UserLogin 
说明：执行业务检查：1.*.用户不存在
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:29
类型：Business 业务对象：UserLogin 
说明：执行业务检查：2.*.用户密码错误
***************************************************************************************************************
SQL:
select 1 from tUser where s_UserNO=@:UserNO and s_Password=@:Password
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:""
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:29
类型：Business 业务对象：UserLogin 
说明：执行业务过程[1]：0.查询用户名
***************************************************************************************************************
SQL:
select UserName = s_UserName from tUser where s_UserNO=@UserNO
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:""
（3）ParameterName:"@UserName" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（5）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:29
类型：Business 业务对象：UpdateSessionState 
说明：执行业务过程[1]：0.更新最新的Session状态
***************************************************************************************************************
SQL:

if not exists(select 1 from tSessionStateRecord where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent and s_UserNO = @UserNO)
begin

INSERT INTO [tSessionStateRecord]
           ([s_IPAddress]
           ,[s_UserAgent]
           ,s_UserNO
           ,[d_LoginTime]
           ,n_HoldingTime)
     VALUES
           (@IPAddress
           ,@UserAgent
           ,@UserNO
           ,GETDATE()
           ,30) 

end
else
begin

update [tSessionStateRecord] set [d_LoginTime] = GETDATE(),n_HoldingTime = 30
where [s_IPAddress] = @IPAddress and [s_UserAgent] = @UserAgent
and s_UserNO = @UserNO



end
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Password" DbType:"AnsiString" Value:"D63901D9A1C3CC97"
（2）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（3）ParameterName:"@Operator" DbType:"AnsiString" Value:"null"
（4）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:30
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:31
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:31
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:44
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:45
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:45
类型：Query 查询对象：SelRoles 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:



SELECT * from (
SELECT  
    RowNumber=ROW_NUMBER() OVER (order by s_RoleID),
    RoleID=s_RoleID,
    RoleName=s_RoleName
from tRole
) T
WHERE T.RowNumber BETWEEN @beginIndex and @endIndex
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（3）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:45
类型：Query 查询对象：SelRoles 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
select
   RowsCount= Count(1)
from tRole
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（3）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:47
类型：Query 查询对象：SelPowersByRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
SELECT distinct PowerID=rp.s_PowerID,PowerName=s_PowerName FROM tRolePower rp
join tPower p on rp.s_PowerID=p.s_PowerID
where rp.s_RoleID=@RoleID
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:50
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:51
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:51
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:51
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"0"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:56
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:22:56
类型：Query 查询对象：SelPowersByModuleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
-- if @ModuleID='_Default_Role'
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic
--   from tPower p
--  where p.n_Type=1--默认权限
--   order by p.n_Type ,p.s_PowerID
--else
--   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type  ,IsPublic=p.b_IsPublic
--   from tModulePower mp
--   join tPower p on mp.s_PowerID=p.s_PowerID
--  where mp.s_ModuleID=@ModuleID
--   order by p.n_Type ,p.s_PowerID


if @ModuleID='_Default_Role'
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=b_IsPublic,IsCheck=1
   from tPower p
  where p.n_Type=1--默认权限
   order by p.n_Type ,p.s_PowerID
else
   select PowerID=p.s_PowerID,PowerName=p.s_PowerName,PowerType=p.n_Type ,IsPublic=p.b_IsPublic,
IsCheck=(case isnull(tRolePower.s_RoleID,'') when '' then 0 else 1 end)
   from tModulePower mp with(nolock)
  left join tPower p with(nolock) on mp.s_PowerID=p.s_PowerID
  left join  tRolePower with(nolock) on tRolePower.s_PowerID = mp.s_PowerID
  and s_RoleID = @RoleID
  where mp.s_ModuleID=@ModuleID
   order by p.n_Type ,p.s_PowerID

 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ModuleID" DbType:"AnsiString" Value:"hwcrkjltj"
（1）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（3）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:00
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务检查：1.*.角色编码已经存在
***************************************************************************************************************
SQL:
if @:UpdateFlag='add'
begin
   if not exists( select 1 from tRole where s_RoleID=@:RoleID)
      select 1
end
else
   select 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务检查：2.*.角色名称已经存在
***************************************************************************************************************
SQL:
if @:UpdateFlag='add'
begin
   if not exists( select 1 from tRole where s_RoleName=@:RoleName)
      select 1
end
else
   select 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务过程[1]：0.添加角色
***************************************************************************************************************
SQL:
if @UpdateFlag='add'
insert into tRole (
    s_RoleID,
    s_RoleName
)values (
    @RoleID,
    @RoleName
)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务过程[2]：0.删除角色与权限关系
***************************************************************************************************************
SQL:
 --delete from tRolePower where s_RoleID=@RoleID
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务过程[3]：0.更新角色与权限关系
***************************************************************************************************************
SQL:
 
--insert into tRolePower (
--    s_RoleID,
--    s_PowerID
--)values (
--    @RoleID,
--    @PowerID
--)


delete from tRolePower where s_RoleID=@RoleID and s_PowerID = @PowerID


if(@PowerState = '1')
begin

insert into tRolePower (
    s_RoleID,
    s_PowerID
)values (
    @RoleID,
    @PowerID
)
  
end  

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"StockInOutRecord"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:23:01
类型：Business 业务对象：SaveRolePower 
说明：执行业务过程[3]：1.更新角色与权限关系
***************************************************************************************************************
SQL:
 
--insert into tRolePower (
--    s_RoleID,
--    s_PowerID
--)values (
--    @RoleID,
--    @PowerID
--)


delete from tRolePower where s_RoleID=@RoleID and s_PowerID = @PowerID


if(@PowerState = '1')
begin

insert into tRolePower (
    s_RoleID,
    s_PowerID
)values (
    @RoleID,
    @PowerID
)
  
end  

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@PowerID" DbType:"String" Value:"SelStockInOutRecordList"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（2）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（3）ParameterName:"@RoleID" DbType:"AnsiString" Value:"001"
（4）ParameterName:"@RoleName" DbType:"AnsiString" Value:"超级管理员"
（5）ParameterName:"@UpdateFlag" DbType:"AnsiString" Value:"update"
（6）ParameterName:"@PowerState" DbType:"String" Value:"1"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:05
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:05
类型：Query 查询对象：SelBoardModule 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select s_ModuleID,s_ModuleName,s_Url from tModule where s_ModuleName like '%看板%' and n_IsLeaf = 1
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"" DbType:"String" Value:"null"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:07
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:08
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:09
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"0"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:09
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"cfjcxxgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:09
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmshcqkcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:09
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wms-kcgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:10
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"wmssczdcrkgl"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:10
类型：Query 查询对象：SelModules 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:

declare @pID varchar(50)
select @pID=@ParentID
create table #t1(RoleID varchar(50),PowerID varchar(50))
if @pID ='0' or @IsCheckPower=0
begin
	insert into #t1(PowerID)
	select PowerID='1'
end 
else
begin
	insert into #t1(RoleID,PowerID)
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@Operator
/*
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  
	from tPower where n_Type=1
*/
--防止与默认权限重复2016-12-07 rolin
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=p.s_PowerID  
	from tPower p
	right join #t1 t on p.s_PowerID=t.PowerID
	where p.n_Type=1
	and p.s_PowerID is null
end



SELECT
ModuleID=s_ModuleID,
ModuleName=s_ModuleName,
Tag=n_Tag,
ParentID=s_ParentID,
--Controller=(select top 1 Value from SplitString(s_Url,'/',1)),
IsCom=b_IsCom,
Url=s_Url,
IconUrl=s_IconUrl,
IsLeaf=n_IsLeaf
FROM tModule m
right join #t1 t on t.PowerID=case 
								when @pID  ='0' then t.PowerID
								when @IsCheckPower=0 then t.PowerID
								else (select top 1 Value from SplitString(s_Url,'/',1))
						end
where s_ParentID=@pID 
AND n_Tag&1=0    --位运算1为删除
AND (
	select COUNT(1) from tModulePower mp 
	join #t1 rp on mp.s_PowerID=rp.PowerID 
	where mp.s_ModuleID=m.s_ModuleID)> 
		case when m.n_IsLeaf=1 and @IsCheckPower=1 then 0
		else -1
    end
ORDER BY n_No


drop table #t1




^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@ParentID" DbType:"AnsiString" Value:"SysMg"
（1）ParameterName:"@IsCheckPower" DbType:"Boolean" Value:"1"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:11
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:11
类型：Query 查询对象：SelSessionState 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select top 1 LoginState = 
(case when 
DATEDIFF(MINUTE,d_LoginTime,GETDATE())
< n_HoldingTime then 0 else 1 end),
UserNO = s_UserNO
 from tSessionStateRecord 
where [s_IPAddress] = @IPAddress 
and [s_UserAgent] = @UserAgent
and s_UserNO <> ''
order by d_LoginTime desc
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@IPAddress" DbType:"AnsiString" Value:"127.0.0.1"
（1）ParameterName:"@UserAgent" DbType:"AnsiString" Value:"Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36"
（2）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:24:17
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:30:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:30:54
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:30:54
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:30:54
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:30:54
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:31:59
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:32:06
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:32:07
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:32:07
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:32:07
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:40:33
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:40:34
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:40:34
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:40:34
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and [s_ListStockInOut_ExternalCode] like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then [s_ListStockInOut_ExternalCode] else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:29
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:36
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:43
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:43
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:43
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:44
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:49
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:49
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:49
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:41:49
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and [s_BillStockInOut_Code] like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then [s_BillStockInOut_Code] else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:19
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:24
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:24
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:24
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:25
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:27
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:28
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:28
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:28
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:38
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:39
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:39
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:42:39
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where n_BillStockInOut_Id = isnull(@n_BillStockInOut_Id,0)
  and isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@n_BillStockInOut_Id" DbType:"AnsiString" Value:""
（6）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（7）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（8）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（9）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:43:49
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:43:55
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:43:55
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:43:55
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 16:43:55
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:07:26
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:07:33
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:07:34
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:07:34
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:07:34
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:13:39
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:13:46
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:13:47
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:13:47
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]
      ,[n_ListStockInOut_state]
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:13:47
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:14:45
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:14:52
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:14:53
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:14:53
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:14:53
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:15:38
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:15:47
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:15:47
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:15:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,[d_ListStockInOut_WarehousingTime]
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,[d_ListStockInOut_WarehouseOutTime]
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:15:48
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:16:50
类型：Query 查询对象：SelPowersByUserNO 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
if exists(
	select 1 from tUser where s_UserNO=@UserNO
)
--如果是登录用户
begin
	select RoleID=ur.s_RoleID,PowerID=rp.s_PowerID 
	into #t1
	from 
	tUser u
	join tUserRole ur on u.s_UserNO=ur.s_UserID
	join tRolePower rp on rp.s_RoleID=ur.s_RoleID
	where s_UserNO=@UserNO
	
	insert into #t1 (RoleID,PowerID) 
	select RoleID='defaule',PowerID=s_PowerID  from tPower where n_Type=1
	
	select * from #t1
drop table #t1
end
else
	--如果是非登录用户，只获取公开权限
	select RoleID='public',PowerID=s_PowerID  from tPower where b_IsPublic=1

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:16:50
类型：Query 查询对象：SelOperatorRoleID 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select OperatorRoleID=s_RoleID from tRole where s_RoleID in( select s_RoleID from tUserRole where s_UserID=@UserNO)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@UserNO" DbType:"AnsiString" Value:"admin"
（1）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:16:50
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(1)
***************************************************************************************************************
SQL:
select * from ( select RowNumber=row_number() over(order by d_ListStockInOut_CreateTime asc),* from (
SELECT 
--[Columns]
     [n_ListStockInOut_Id]
      ,[s_BillStockInOut_Code]
      ,[n_Warehouse_Id]
      ,[n_Shopfloor_Id]
      ,[n_BillStockInOut_Id]
      ,[n_BillStockInOutDetail_Id]
      ,[n_Bin_Id]
      ,[n_ListStockInOut_GoodsId]
      ,[s_ListStockInOut_GoodsProductName]
      ,[s_ListStockInOut_GoodsProductCode]
      ,[n_ListStockInOut_GoodsProductId]
      ,[s_ListStockInOut_ExternalCode]
      ,[s_ListStockInOut_ExternalName]
      ,[s_ListStockInOut_ECN]
      ,[n_APQPStatus_Id]
      ,[s_APQPStatus_Name]
      ,[s_ListStockInOut_QualityStatus]=(case [s_ListStockInOut_QualityStatus] when 1 then '合格'
      when 2 then '待定'
      when 3 then '报废'
      when 4 then '返工'
      else '' end)
      ,[s_ListStockInOut_SpecificationAndModel]
      ,[s_ListStockInOut_Unit]
      ,[s_ListStockInOut_Model]
      ,[s_ListStockInOut_Color]
      ,[s_ListStockInOut_BatchNumber]
      ,Convert(varchar(20),[d_ListStockInOut_WarehousingTime],120) as d_ListStockInOut_WarehousingTime
      ,[n_ListStockInOut_WarehousingQuantity]
      ,[n_ListStockInOut_WarehousingOKProductCou]
      ,[n_ListStockInOut_WarehousingUnOKProductCou]
      ,[n_ListStockInOut_WarehousingReworkProductCou]
      ,[s_ListStockInOut_WarehousingOperator]
      ,[s_ListStockInOut_WarehousingClasses]
      ,[n_WarehousingReason_Id]
      ,[s_WarehousingReason_Name]
      ,[n_WarehousingReason_Type]
      ,[n_ListStockInOut_WarehousingSequence]
      ,Convert(varchar(20),[d_ListStockInOut_WarehouseOutTime],120) as d_ListStockInOut_WarehouseOutTime
      ,[n_ListStockInOut_WarehouseOutQuantity]
      ,[n_ListStockInOut_WarehouseOutOKProductCou]
      ,[n_ListStockInOut_WarehouseOutUnOKProductCou]
      ,[n_ListStockInOut_WarehouseOutReworkProductCou]
      ,[s_ListStockInOut_WarehouseOutOperator]
      ,[s_ListStockInOut_WarehouseOutClasses]
      ,[n_WarehouseOutReason_Id]
      ,[s_WarehouseOutReason_Name]
      ,[n_WarehouseOutReason_Type]
      ,[n_ListStockInOut_WarehouseOutSequence]
      ,[s_ListStockInOut_CustomFields1]
      ,[s_ListStockInOut_CustomFields2]
      ,[s_ListStockInOut_CustomFields3]
      ,[s_ListStockInOut_CustomFields4]
      ,[s_ListStockInOut_CustomFields5]
      ,[s_ListStockInOut_CustomFields6]
      ,[s_ListStockInOut_CustomFields7]
      ,[s_ListStockInOut_CustomFields8]
      ,[s_ListStockInOut_CustomFields9]
      ,[s_ListStockInOut_CustomFields10]
      ,[s_ListStockInOut_WhetherToSubmit]=(case s_ListStockInOut_WhetherToSubmit when 0 then '否' else '是' end)
      ,[n_ListStockInOut_state]=(case n_ListStockInOut_state when 1 then '正常' else '停用' end)
      ,[s_ListStockInOut_Creator]
      ,[d_ListStockInOut_CreateTime]
      ,[s_ListStockInOut_Updator]
      ,[d_ListStockInOut_UpdateTime]
--[/Columns]
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
) T_pagenation  ) TT_pagenation  where RowNumber between @beginIndex and @endIndex 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
**************************************************************************************************************------>2020/10/23 17:16:50
类型：Query 查询对象：SelStockInOutRecordList 
说明：执行查询对象查询(合计查询)
***************************************************************************************************************
SQL:
 select RowsCount=COUNT(1) from ( 
SELECT 
 R=1 
  FROM [dbo].[tListStockInOut] with(nolock)
  where  isnull([s_BillStockInOut_Code],0) like (case when ISNULL(@s_BillStockInOut_Code,'') = ''
  then isnull([s_BillStockInOut_Code],0) else '%'+@s_BillStockInOut_Code+'%' end)
  and isnull([s_ListStockInOut_ExternalCode],0) like (case when ISNULL(@s_ListStockInOut_ExternalCode,'') = ''
  then isnull([s_ListStockInOut_ExternalCode],0) else '%'+@s_ListStockInOut_ExternalCode+'%' end)
  and s_ListStockInOut_ExternalName like (case when ISNULL(@s_ListStockInOut_ExternalName,'') = ''
  then s_ListStockInOut_ExternalName else '%'+@s_ListStockInOut_ExternalName+'%' end)
  and [n_ListStockInOut_state] = (case isnull(@n_ListStockInOut_state,0) when 0
  then [n_ListStockInOut_state] else @n_ListStockInOut_state end)
  and s_ListStockInOut_WhetherToSubmit = (case isnull(@s_ListStockInOut_WhetherToSubmit,0) when 0
  then s_ListStockInOut_WhetherToSubmit else @s_ListStockInOut_WhetherToSubmit end)
 ) T_RowsCount 
 



^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
参数：
（0）ParameterName:"@s_BillStockInOut_Code" DbType:"AnsiString" Value:""
（1）ParameterName:"@s_ListStockInOut_ExternalCode" DbType:"AnsiString" Value:""
（2）ParameterName:"@s_ListStockInOut_ExternalName" DbType:"AnsiString" Value:""
（3）ParameterName:"@n_ListStockInOut_state" DbType:"Int32" Value:"1"
（4）ParameterName:"@s_ListStockInOut_WhetherToSubmit" DbType:"Int32" Value:"0"
（5）ParameterName:"@Operator" DbType:"AnsiString" Value:"admin"
（6）ParameterName:"@OperatorRoleID" DbType:"AnsiString" Value:"001"
（7）ParameterName:"@beginIndex" DbType:"Int32" Value:"1"
（8）ParameterName:"@endIndex" DbType:"Int32" Value:"20"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^